/** * Created by jbmar on 16/05/2017. */function submitPhoto() {    $('#frmUploader').ajaxSubmit({        success: showResponse    });    return false;}function showResponse(responseText, statusText, xhr, $form) {    let dataRes = JSON.parse(xhr.responseText),        divError = $("#error")    ;    $('<div/>', {        id: dataRes.response.idPhoto,        class: 'div-photo-user',        css: {            'background-image': 'url(' + dataRes.response.srcPhoto + ')'        },        prependTo: $('#photos-user-account'),        on: {            click: function () {                interactPhoto(dataRes.response.idPhoto)            }        }    });    console.log($('.div-photo-user').length);    if ($('.div-photo-user').length >= 5) {        $('.input-file-trigger').css('display', 'none');    }    if ((dataRes.isErr === 0 || dataRes.isErr === 1) && (dataRes.response)) {        divError.removeClass('red green');        dataRes.isErr === 1 ?            divError.addClass('red') : divError.addClass('green');        dataRes.isErr === 1 ?            divError.text(dataRes.response) : divError.text(dataRes.response.mess);    }}$('body').on('click', function (e) {    if (e.target.classList.contains('div-photo-user') ||        e.target.classList.contains('del') ||        e.target.classList.contains('profil')) {        return false;    }    reduceInteract();});function reduceInteract() {    $('#interact-photos').removeClass('expand');    $('.div-photo-user').removeClass('profil');    $('#imgStar').removeClass('profilStar');    $('#interact-photos').css('display', 'none');}function interactPhoto(photoId) {    var divError = $("#error");    divError.removeClass('red green');    $('#interact-photos').css('display', 'block');    $('.div-photo-user').removeClass('profil');    $('#interact-photos').addClass('expand');    $('#' + photoId).addClass('profil');    $('#imgStar').addClass('profilStar');    $('#button-del-account').off('click').on('click', function () {        removePhoto(photoId);    });    $('#button-profil-account').off('click').on('click', function () {        addFavoritePhoto(photoId);    });}function removePhoto(idPhoto) {    const testIfStar = $('#' + idPhoto)[0].classList.contains('star');    if (testIfStar) {        var divError = $("#error");        divError.removeClass('red green');        divError.addClass('red');        divError.text("Selectionne une autre photo de profil afin de pouvoir supprimer celle-ci !");    } else {        $.post('/account/Delete', {id: idPhoto}, function (data, textStatus, jqXHR) {            var dataRes = JSON.parse(jqXHR.responseText),                divError = $("#error")            ;            divError.removeClass('red green');            dataRes.isErr === 1 ? divError.addClass('red') : divError.addClass('green');            divError.text(dataRes.response);            $('#' + idPhoto).remove();            console.log($('.div-photo-user').length);            if ($('.div-photo-user').length <= 5) {                $('.input-file-trigger').css('display', 'inline-block');            }            reduceInteract();        });    }}function addFavoritePhoto(idPhoto) {    $.post('/account/Favorite', {id: idPhoto}, function (data, textStatus, jqXHR) {        var dataRes = JSON.parse(jqXHR.responseText),            divError = $("#error")        ;        divError.removeClass('red green');        if (dataRes.response !== 0 && dataRes.response !== 1) {            dataRes.isErr === 1 ? divError.addClass('red') : divError.addClass('green');            divError.text(dataRes.response);        }        $('#imgStar').remove();        $('.div-photo-user').removeClass('star');        let imgStar = $('<img/>', {            id: "imgStar",            class: "imgStar profilStar",            src: "/images/tools/star.png",        });        $('#' + idPhoto).addClass('star').after(imgStar);        $('#default-img-user').addClass('fav');        $('#default-img-user').attr('src', dataRes.response.src);        reduceInteract();    });}function submitForm(input) {    let checkInput = false;    if ((checkInput = checkIfInputIsModify(input)) !== false) {        $.post('/account/Modify-Profil', {input: input, data: checkInput}, function (data, textStatus, jqXHR) {            var dataRes = JSON.parse(jqXHR.responseText),                divError = $("#errorInfoProfil")            ;            divError.removeClass('red green');            if (dataRes.response !== 0 && dataRes.response !== 1) {                sendResponseAfterModifyForm(dataRes, divError);            }            divError.text(dataRes.response.mess);        });    }}function checkIfInputIsModify(input) {    let checkInput = "",        diff = ""    ;    if (input === 'email') {        diff = $("#hiddenEmailAccountInput").val();        checkInput = $('#emailAccountInput').val();        if (diff !== checkInput) {            return checkInput;        }    } else if (input === 'login') {        diff = $("#hiddenloginAccountInput").val();        checkInput = $('#loginAccountInput').val();        if (diff !== checkInput) {            return checkInput;        }    } else if (input === 'name') {        diff = $("#hiddenNameAccountInput").val();        checkInput = $('#lastNameAccountInput').val();        if (diff !== checkInput) {            return checkInput;        }    } else if (input === 'firstName') {        diff = $("#hiddenFirstNameAccountInput").val();        checkInput = $('#firstNameAccountInput').val();        if (diff !== checkInput) {            return checkInput;        }    }    return false;}function sendResponseAfterModifyForm(dataRes, divError) {    dataRes.isErr === 1 ? divError.addClass('red') : divError.addClass('green');    if (dataRes.response.input === "email") {        $('#emailAccountInput').removeClass('red green');        dataRes.isErr === 1 ? $('#emailAccountInput').addClass('red') : $('#emailAccountInput').addClass('green');        if (dataRes.isErr === 0) {            $("input.hiddenEmailRegisterInput").val(dataRes.response.data);        }    } else if (dataRes.response.input === "login") {        $('#loginAccountInput').removeClass('red green');        dataRes.isErr === 1 ? $('#loginAccountInput').addClass('red') : $('#loginAccountInput').addClass('green');        if (dataRes.isErr === 0) {            var welcome = $("#welcome-account");            console.log(welcome);            $("input.hiddenloginRegisterInput").val(dataRes.response.data);            welcome.text("Bienvenue " + dataRes.response.data);        }    } else if (dataRes.response.input === "name") {        $('#lastNameAccountInput').removeClass('red green');        dataRes.isErr === 1 ? $('#lastNameAccountInput').addClass('red') : $('#lastNameAccountInput').addClass('green');        if (dataRes.isErr === 0) {            $("input.hiddenNameRegisterInput").val(dataRes.response.data);        }    } else if (dataRes.response.input === "firstName") {        $('#firstNameAccountInput').removeClass('red green');        dataRes.isErr === 1 ? $('#firstNameAccountInput').addClass('red') : $('#firstNameAccountInput').addClass('green');        if (dataRes.isErr === 0) {            $("input.hiddenFirstNameRegisterInput").val(dataRes.response.data);        }    }}